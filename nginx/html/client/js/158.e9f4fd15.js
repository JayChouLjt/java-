"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[158,410],{8410:function(e,a,l){l.r(a),l.d(a,{default:function(){return W}});var o=l(3396);const r=(0,o.Uk)("女"),t=(0,o.Uk)("男"),s=(0,o.Uk)("保密"),n=(0,o.Uk)("取消"),u=(0,o.Uk)("保存");function d(e,a,l,d,m,i){const c=(0,o.up)("el-input"),p=(0,o.up)("el-form-item"),w=(0,o.up)("el-radio"),f=(0,o.up)("el-radio-group"),g=(0,o.up)("el-date-picker"),b=(0,o.up)("el-option"),W=(0,o.up)("el-select"),_=(0,o.up)("el-button"),h=(0,o.up)("el-form");return(0,o.wg)(),(0,o.j4)(h,{ref:"updateForm","label-width":"70px",model:e.registerForm,rules:e.SignUpRules},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{prop:"username",label:"用户名"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{modelValue:e.registerForm.username,"onUpdate:modelValue":a[0]||(a[0]=a=>e.registerForm.username=a),placeholder:"用户名"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,{label:"性别"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{modelValue:e.registerForm.sex,"onUpdate:modelValue":a[1]||(a[1]=a=>e.registerForm.sex=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{label:0},{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(w,{label:1},{default:(0,o.w5)((()=>[t])),_:1}),(0,o.Wm)(w,{label:2},{default:(0,o.w5)((()=>[s])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(p,{prop:"birth",label:"生日"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{type:"date",placeholder:"选择日期",modelValue:e.registerForm.birth,"onUpdate:modelValue":a[2]||(a[2]=a=>e.registerForm.birth=a),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,{prop:"introduction",label:"签名"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{type:"textarea",placeholder:"签名",modelValue:e.registerForm.introduction,"onUpdate:modelValue":a[3]||(a[3]=a=>e.registerForm.introduction=a)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,{prop:"location",label:"地区"},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{modelValue:e.registerForm.location,"onUpdate:modelValue":a[4]||(a[4]=a=>e.registerForm.location=a),placeholder:"地区",style:{width:"100%"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.AREA,(e=>((0,o.wg)(),(0,o.j4)(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(p,{prop:"phoneNum",label:"手机"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{placeholder:"手机",modelValue:e.registerForm.phoneNum,"onUpdate:modelValue":a[5]||(a[5]=a=>e.registerForm.phoneNum=a)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,{prop:"email",label:"邮箱"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{modelValue:e.registerForm.email,"onUpdate:modelValue":a[6]||(a[6]=a=>e.registerForm.email=a),placeholder:"邮箱"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,{onClick:a[7]||(a[7]=a=>e.goBack(-1))},{default:(0,o.w5)((()=>[n])),_:1}),(0,o.Wm)(_,{type:"primary",onClick:a[8]||(a[8]=a=>e.saveMsg())},{default:(0,o.w5)((()=>[u])),_:1})])),_:1})])),_:1},8,["model","rules"])}var m=l(4870),i=l(9749),c=l(8045),p=l(754),w=l(2167),f=(0,o.aZ)({setup(){const{proxy:e}=(0,o.FN)(),a=(0,i.oR)(),{goBack:l}=(0,c.Z)(),r=(0,m.qj)({username:"",sex:"",phoneNum:"",email:"",birth:new Date,introduction:"",location:"",userPic:""}),t=(0,o.Fl)((()=>a.getters.userId));async function s(e){const a=await w.x.getUserOfId(e);r.username=a.data[0].username,r.sex=a.data[0].sex,r.phoneNum=a.data[0].phoneNum,r.email=a.data[0].email,r.birth=a.data[0].birth,r.introduction=a.data[0].introduction,r.location=a.data[0].location,r.userPic=a.data[0].avator}async function n(){let a=!0;if(e.$refs["updateForm"].validate((e=>{if(!e)return a=!1})),!a)return;const o=t.value,s=r.username,n=r.sex,u=r.phoneNum,d=r.email,m=r.birth,i=r.introduction,c=r.location,p=await w.x.updateUserMsg({id:o,username:s,sex:n,phoneNum:u,email:d,birth:m,introduction:i,location:c});e.$message({message:p.message,type:p.type}),p.success&&(e.$store.commit("setUsername",r.username),l(-1))}return(0,o.bv)((()=>{s(t.value)})),{AREA:p.q1,registerForm:r,SignUpRules:p._P,saveMsg:n,goBack:l}}}),g=l(89);const b=(0,g.Z)(f,[["render",d],["__scopeId","data-v-469c15bb"]]);var W=b},4158:function(e,a,l){l.r(a),l.d(a,{default:function(){return F}});var o=l(3396);const r=e=>((0,o.dD)("data-v-de74148a"),e=e(),(0,o.Cn)(),e),t={class:"setting"},s=r((()=>(0,o._)("h1",null,"设置",-1))),n=(0,o.Uk)("注销账号");function u(e,a,l,r,u,d){const m=(0,o.up)("Personal-data"),i=(0,o.up)("el-tab-pane"),c=(0,o.up)("Password"),p=(0,o.up)("el-button"),w=(0,o.up)("el-tabs");return(0,o.wg)(),(0,o.iD)("div",t,[s,(0,o.Wm)(w,{"tab-position":"left"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{label:"个人资料",class:"content"},{default:(0,o.w5)((()=>[(0,o.Wm)(m)])),_:1}),(0,o.Wm)(i,{label:"更改密码",class:"content"},{default:(0,o.w5)((()=>[(0,o.Wm)(c)])),_:1}),(0,o.Wm)(i,{label:"账号和安全",class:"content"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{type:"danger",icon:e.Delete,onClick:e.cancelAccount},{default:(0,o.w5)((()=>[n])),_:1},8,["icon","onClick"])])),_:1})])),_:1})])}var d=l(547),m=l(8410);const i=(0,o.Uk)("重置"),c=(0,o.Uk)("确认修改");function p(e,a,l,r,t,s){const n=(0,o.up)("el-input"),u=(0,o.up)("el-form-item"),d=(0,o.up)("el-button"),m=(0,o.up)("el-form");return(0,o.wg)(),(0,o.j4)(m,{ref:"passwordForm","label-width":"70px",model:e.form,rules:e.rules},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{label:"旧密码",prop:"oldPassword"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{type:"password",modelValue:e.form.oldPassword,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.oldPassword=a)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(u,{label:"新密码",prop:"newPassword"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{type:"password",modelValue:e.form.newPassword,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.newPassword=a)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(u,{label:"密码确认",prop:"confirmPassword"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{type:"password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.confirmPassword=a)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onClick:a[3]||(a[3]=a=>e.clearData())},{default:(0,o.w5)((()=>[i])),_:1}),(0,o.Wm)(d,{type:"primary",onClick:a[4]||(a[4]=a=>e.confirm())},{default:(0,o.w5)((()=>[c])),_:1})])),_:1})])),_:1},8,["model","rules"])}l(1703);var w=l(4870),f=l(9749),g=l(8045),b=l(2167),W=l(754),_=(0,o.aZ)({setup(){const e=(0,f.oR)(),{proxy:a}=(0,o.FN)(),{goBack:l}=(0,g.Z)(),r=(0,w.qj)({oldPassword:"",newPassword:"",confirmPassword:""}),t=(0,o.Fl)((()=>e.getters.userId)),s=(0,o.Fl)((()=>e.getters.username)),n=(e,a,l)=>{""===a?l(new Error("密码不能为空")):a!==r.newPassword?l(new Error("请输入正确密码")):l()},u=(0,w.qj)({oldPassword:[{validator:W.uo,trigger:"blur",min:3}],newPassword:[{validator:W.uo,trigger:"blur",min:3}],confirmPassword:[{validator:n,trigger:"blur",min:3}]});async function d(){r.oldPassword="",r.newPassword="",r.confirmPassword=""}async function m(){let e=!0;if(a.$refs["passwordForm"].validate((a=>{if(!a)return e=!1})),!e)return;const o=t.value,n=s.value,u=r.oldPassword,d=r.newPassword,m=await b.x.updateUserPassword({id:o,username:n,oldPassword:u,password:d});a.$message({message:m.message,type:m.type}),m.success&&l()}return{form:r,clearData:d,confirm:m,rules:u}}}),h=l(89);const v=(0,h.Z)(_,[["render",p]]);var P=v,V=(0,o.aZ)({components:{PersonalData:m["default"],Password:P},setup(){const{proxy:e}=(0,o.FN)(),a=(0,f.oR)(),{routerManager:l}=(0,g.Z)(),r=(0,o.Fl)((()=>a.getters.userId));async function t(){const a=await b.x.deleteUser(r.value);e.$message({message:a.message,type:a.type}),l(W.wC.SignIn,{path:W.wC.SignIn}),e.$store.commit("setToken",!1)}return{Delete:d.Z,cancelAccount:t}}});const y=(0,h.Z)(V,[["render",u],["__scopeId","data-v-de74148a"]]);var F=y}}]);
//# sourceMappingURL=158.e9f4fd15.js.map