"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[380],{2024:function(e,t,n){function a(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,l=t.getDate()<10?"0"+t.getDate():t.getDate();return n+"-"+a+"-"+l}function l(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,l=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),r=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return n+"-"+a+"-"+l+" "+s+":"+o+":"+r}function s(e){let t=e.split("\n");const n=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,a=[];if(!/\[.+\]/.test(e))return[[0,e]];while(!n.test(t[0]))t=t.slice(1);0===t[t.length-1].length&&t.pop();for(const l of t){const e=l.match(n),t=l.replace(n,"");for(const n of e){const e=n.slice(1,-1).split(":");""!==t&&a.push([60*parseInt(e[0],10)+parseFloat(e[1]),t])}}return a.sort(((e,t)=>e[0]-t[0])),a}function o(e){let t=parseInt(e),n=0,a=0;t>60&&(n=parseInt((t/60).toString()),t=parseInt((t%60).toString()),n>60&&(a=parseInt((n/60).toString()),n=60));let l="";return l=parseInt(t.toString())<10?"0:0"+parseInt(t.toString()):"0:"+parseInt(t.toString()),n>0&&(l=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),l=parseInt(n.toString())+":"+l),a>0&&(l=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),l=parseInt(a.toString())+":"+parseInt(n.toString())+":"+l),l}n.d(t,{oy:function(){return a},p6:function(){return l},zu:function(){return s},ZC:function(){return o}})},5578:function(e,t,n){n.d(t,{Z:function(){return Z}});var a=n(3396),l=n(7139);const s=e=>((0,a.dD)("data-v-85fd2866"),e=e(),(0,a.Cn)(),e),o={class:"comment"},r={class:"comment-title"},u=s((()=>(0,a._)("span",null,"评论",-1))),i={class:"comment-desc"},c=(0,a.Uk)("发表评论"),d={class:"popular"},p={class:"popular-msg"},g={class:"name"},m={class:"time"},w={class:"content"},f=["onClick"];function v(e,t,n,s,v,h){const I=(0,a.up)("el-input"),k=(0,a.up)("el-button"),y=(0,a.up)("el-image"),S=(0,a.up)("yin-icon"),_=(0,a.up)("delete"),x=(0,a.up)("el-icon");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a._)("h2",r,[u,(0,a._)("span",i,"共 "+(0,l.zw)(e.commentList.length)+" 条评论",1)]),(0,a.Wm)(I,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:e.textarea,"onUpdate:modelValue":t[0]||(t[0]=t=>e.textarea=t)},null,8,["modelValue"]),(0,a.Wm)(k,{class:"sub-btn",type:"primary",onClick:t[1]||(t[1]=t=>e.submitComment())},{default:(0,a.w5)((()=>[c])),_:1})]),(0,a._)("ul",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.commentList,((t,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n},[(0,a.Wm)(y,{class:"popular-img",fit:"contain",src:e.attachImageUrl(t.avator)},null,8,["src"]),(0,a._)("div",p,[(0,a._)("ul",null,[(0,a._)("li",g,(0,l.zw)(t.username),1),(0,a._)("li",m,(0,l.zw)(e.formatDate(t.createTime)),1),(0,a._)("li",w,(0,l.zw)(t.content),1)])]),(0,a._)("div",{ref_for:!0,ref:"up",class:"comment-ctr",onClick:n=>e.setSupport(t.id,t.up,e.userId)},[(0,a._)("div",null,[(0,a.Wm)(S,{icon:e.iconList.Support},null,8,["icon"]),(0,a.Uk)(" "+(0,l.zw)(t.up),1)]),t.userId===e.userId?((0,a.wg)(),(0,a.j4)(x,{key:0,onClick:a=>e.deleteComment(t.id,n)},{default:(0,a.w5)((()=>[(0,a.Wm)(_)])),_:2},1032,["onClick"])):(0,a.kq)("",!0)],8,f)])))),128))])],64)}var h=n(4870),I=n(9749),k=n(547),y=n(3089),S=n(8045),_=n(2167),x=n(754),C=n(2024),D=(0,a.aZ)({components:{YinIcon:y.Z,Delete:k.Z},props:{playId:Number||String,type:Number},setup(e){const{proxy:t}=(0,a.FN)(),n=(0,I.oR)(),{checkStatus:l}=(0,S.Z)(),{playId:s,type:o}=(0,h.BK)(e),r=(0,h.iH)([]),u=(0,h.iH)(""),i=(0,h.qj)({Support:x.JO.Support}),c=(0,a.Fl)((()=>n.getters.userId)),d=(0,a.Fl)((()=>n.getters.songId));async function p(){try{const e=await _.x.getAllComment(o.value,s.value);r.value=e.data;for(let t=0;t<r.value.length;t++){const e=await _.x.getUserOfId(r.value[t].userId);r.value[t].avator=e.data[0].avator,r.value[t].username=e.data[0].username}}catch(e){console.error(e)}}async function g(){if(!l())return;let e=null,n=null,a=null;1===o.value?(a=1,e=`${s.value}`):0===o.value&&(a=0,n=`${s.value}`);const r=c.value,i=u.value,d=await _.x.setComment({userId:r,content:i,songId:n,songListId:e,nowType:a});t.$message({message:d.message,type:d.type}),d.success&&(u.value="",await p())}async function m(e,n){const a=await _.x.deleteComment(e);t.$message({message:a.message,type:a.type}),a.success&&r.value.splice(n,1)}async function w(e,n,a){if(!l())return;let s=null,o=null;const r=e,u=await _.x.testAlreadySupport({commentId:r,userId:a});t.$message({message:u.message,type:u.type,date:u.data}),u.data?(n-=1,o=await _.x.deleteUserSupport({commentId:r,userId:a}),s=await _.x.setSupport({id:e,up:n})):(n+=1,o=await _.x.insertUserSupport({commentId:r,userId:a}),s=await _.x.setSupport({id:e,up:n})),s.success&&o.success&&await p()}return(0,a.YP)(d,(()=>{p()})),(0,a.bv)((()=>{p()})),{userId:c,commentList:r,textarea:u,iconList:i,attachImageUrl:_.x.attachImageUrl,submitComment:g,setSupport:w,formatDate:C.p6,deleteComment:m}}}),b=n(89);const L=(0,b.Z)(D,[["render",v],["__scopeId","data-v-85fd2866"]]);var Z=L},6319:function(e,t,n){n.d(t,{Z:function(){return C}});var a=n(3396);const l={class:"content"},s=(0,a.Uk)("下载"),o=(0,a.Uk)("删除");function r(e,t,n,r,u,i){const c=(0,a.up)("el-table-column"),d=(0,a.up)("MoreFilled"),p=(0,a.up)("el-icon"),g=(0,a.up)("el-dropdown-item"),m=(0,a.up)("el-dropdown-menu"),w=(0,a.up)("el-dropdown"),f=(0,a.up)("el-table");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)(f,{"highlight-current-row":"",data:e.dataList,onRowClick:e.handleClick},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{prop:"songName",label:"歌曲"}),(0,a.Wm)(c,{prop:"singerName",label:"歌手"}),(0,a.Wm)(c,{prop:"introduction",label:"专辑"}),(0,a.Wm)(c,{label:"编辑",width:"80",align:"center"},{default:(0,a.w5)((t=>[(0,a.Wm)(w,null,{dropdown:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{icon:e.Download,onClick:n=>e.downloadMusic({songUrl:t.row.url,songName:t.row.name})},{default:(0,a.w5)((()=>[s])),_:2},1032,["icon","onClick"]),e.show?((0,a.wg)(),(0,a.j4)(g,{key:0,icon:e.Delete,onClick:n=>e.deleteCollection({id:t.row.id})},{default:(0,a.w5)((()=>[o])),_:2},1032,["icon","onClick"])):(0,a.kq)("",!0)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:n=>e.handleEdit(t.row)},{default:(0,a.w5)((()=>[(0,a.Wm)(d)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","onRowClick"])])}var u=n(4870),i=n(9749),c=n(8045),d=n(9092),p=n(547),g=n(6854);const m=(0,a.aZ)({name:"Download"}),w={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},f=(0,a._)("path",{fill:"currentColor",d:"M160 832h704a32 32 0 110 64H160a32 32 0 110-64zm384-253.696l236.288-236.352 45.248 45.248L508.8 704 192 387.2l45.248-45.248L480 584.704V128h64v450.304z"},null,-1),v=[f];function h(e,t,n,l,s,o){return(0,a.wg)(),(0,a.iD)("svg",w,v)}var I=(0,g.Z)(m,[["render",h]]),k=n(2167),y=n(754),S=(0,a.aZ)({components:{MoreFilled:d.Z},props:{songList:Array,show:{default:!1}},emits:["changeData"],setup(e){const{getSongTitle:t,getSingerName:n,playMusic:l,checkStatus:s,downloadMusic:o}=(0,c.Z)(),{proxy:r}=(0,a.FN)(),d=(0,i.oR)(),{songList:g}=(0,u.BK)(e),m=(0,u.qj)({dislike:y.JO.Dislike,like:y.JO.Like}),w=(0,a.Fl)((()=>d.getters.songUrl)),f=(0,a.Fl)((()=>d.getters.singerName)),v=(0,a.Fl)((()=>d.getters.songTitle)),h=(0,a.Fl)((()=>{const e=[];return g.value.forEach(((a,l)=>{a["songName"]=t(a.name),a["singerName"]=n(a.name),a["index"]=l,e.push(a)})),e}));function S(e){l({id:e.id,url:e.url,pic:e.pic,index:e.index,name:e.name,lyric:e.lyric,currentSongList:g.value})}function _(e){console.log("row",e)}const x=(0,a.Fl)((()=>d.getters.userId));async function C({id:e}){if(!s())return;const t=await k.x.deleteCollection(x.value,e);r.$message({message:t.message,type:t.type}),!1===t.data&&r.$emit("changeData",t.data)}return{dataList:h,iconList:m,Delete:p.Z,Download:I,songUrl:w,singerName:f,songTitle:v,handleClick:S,handleEdit:_,downloadMusic:o,deleteCollection:C}}}),_=n(89);const x=(0,_.Z)(S,[["render",r],["__scopeId","data-v-05112f65"]]);var C=x},3089:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(3396);const l={class:"icon","aria-hidden":"true"},s=["xlink:href"];function o(e,t,n,o,r,u){return(0,a.wg)(),(0,a.iD)("svg",l,[(0,a._)("use",{"xlink:href":e.icon},null,8,s)])}var r=(0,a.aZ)({props:{icon:String}}),u=n(89);const i=(0,u.Z)(r,[["render",o]]);var c=i},9380:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var a=n(3396),l=n(7139);const s=e=>((0,a.dD)("data-v-92e89d70"),e=e(),(0,a.Cn)(),e),o={class:"album-info"},r=s((()=>(0,a._)("h1",null,"简介",-1))),u={class:"album-score"},i=s((()=>(0,a._)("h3",null,"歌单评分",-1)));function c(e,t,n,s,c,d){const p=(0,a.up)("el-image"),g=(0,a.up)("el-aside"),m=(0,a.up)("el-rate"),w=(0,a.up)("song-list"),f=(0,a.up)("comment"),v=(0,a.up)("el-main"),h=(0,a.up)("el-container");return(0,a.wg)(),(0,a.j4)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"album-slide"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"album-img",fit:"contain",src:e.attachImageUrl(e.songDetails.pic)},null,8,["src"]),(0,a._)("h3",o,(0,l.zw)(e.songDetails.title),1)])),_:1}),(0,a.Wm)(v,{class:"album-main"},{default:(0,a.w5)((()=>[r,(0,a._)("p",null,(0,l.zw)(e.songDetails.introduction),1),(0,a._)("div",u,[(0,a._)("div",null,[i,(0,a.Wm)(m,{modelValue:e.rank,"onUpdate:modelValue":t[0]||(t[0]=t=>e.rank=t),"allow-half":"",disabled:""},null,8,["modelValue"])]),(0,a._)("span",null,(0,l.zw)(2*e.rank),1),(0,a._)("div",null,[(0,a._)("h3",null,(0,l.zw)(e.assistText)+" "+(0,l.zw)(2*e.score),1),(0,a.Wm)(m,{"allow-half":"",modelValue:e.score,"onUpdate:modelValue":t[1]||(t[1]=t=>e.score=t),disabled:e.disabledRank,onClick:t[2]||(t[2]=t=>e.pushValue())},null,8,["modelValue","disabled"])])]),(0,a.Wm)(w,{class:"album-body",songList:e.currentSongList},null,8,["songList"]),(0,a.Wm)(f,{playId:e.songListId,type:1},null,8,["playId"])])),_:1})])),_:1})}var d=n(4870),p=n(9749),g=n(8045),m=n(6319),w=n(5578),f=n(2167),v=(0,a.aZ)({components:{SongList:m.Z,Comment:w.Z},setup(){const{proxy:e}=(0,a.FN)(),t=(0,p.oR)(),{checkStatus:n}=(0,g.Z)(),l=(0,d.iH)([]),s=(0,d.iH)(""),o=(0,d.iH)(0),r=(0,d.iH)(0),u=(0,d.iH)(!1),i=(0,d.iH)("评价"),c=(0,a.Fl)((()=>t.getters.songDetails)),m=(0,a.Fl)((()=>t.getters.userId));async function w(e){const t=await f.x.getListSongOfSongId(e);for(const n of t.data){const e=await f.x.getSongOfId(n.songId);l.value.push(e.data[0])}}async function v(e){const t=await f.x.getRankOfSongListId(e);r.value=t.data/2}async function h(e,t){const n=await f.x.getUserRank(e,t);null!=n.data&&(o.value=n.data/2,u.value=!0,i.value="已评价")}async function I(){if(u.value||!n())return;const t=s.value,a=m.value,l=2*o.value;try{const n=await f.x.setRank({songListId:t,consumerId:a,score:l});e.$message({message:n.message,type:n.type}),n.success&&(v(s.value),u.value=!0,i.value="已评价")}catch(r){console.error(r)}}return s.value=c.value.id,h(m.value,s.value),v(s.value),w(s.value),{songDetails:c,rank:r,score:o,disabledRank:u,assistText:i,currentSongList:l,songListId:s,attachImageUrl:f.x.attachImageUrl,pushValue:I}}}),h=n(89);const I=(0,h.Z)(v,[["render",c],["__scopeId","data-v-92e89d70"]]);var k=I}}]);
//# sourceMappingURL=380.29baab81.js.map