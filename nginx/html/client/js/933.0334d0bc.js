"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[933],{2024:function(t,e,n){function l(t){if(null==t||""==t)return"";const e=new Date(t),n=e.getFullYear(),l=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()<10?"0"+e.getDate():e.getDate();return n+"-"+l+"-"+a}function a(t){if(null==t||""==t)return"";const e=new Date(t),n=e.getFullYear(),l=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()<10?"0"+e.getDate():e.getDate(),s=e.getHours()<10?"0"+e.getHours():e.getHours(),r=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return n+"-"+l+"-"+a+" "+s+":"+r+":"+o}function s(t){let e=t.split("\n");const n=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,l=[];if(!/\[.+\]/.test(t))return[[0,t]];while(!n.test(e[0]))e=e.slice(1);0===e[e.length-1].length&&e.pop();for(const a of e){const t=a.match(n),e=a.replace(n,"");for(const n of t){const t=n.slice(1,-1).split(":");""!==e&&l.push([60*parseInt(t[0],10)+parseFloat(t[1]),e])}}return l.sort(((t,e)=>t[0]-e[0])),l}function r(t){let e=parseInt(t),n=0,l=0;e>60&&(n=parseInt((e/60).toString()),e=parseInt((e%60).toString()),n>60&&(l=parseInt((n/60).toString()),n=60));let a="";return a=parseInt(e.toString())<10?"0:0"+parseInt(e.toString()):"0:"+parseInt(e.toString()),n>0&&(a=parseInt(e.toString())<10?"0"+parseInt(e.toString()):parseInt(e.toString()).toString(),a=parseInt(n.toString())+":"+a),l>0&&(a=parseInt(e.toString())<10?"0"+parseInt(e.toString()):parseInt(e.toString()).toString(),a=parseInt(l.toString())+":"+parseInt(n.toString())+":"+a),a}n.d(e,{oy:function(){return l},p6:function(){return a},zu:function(){return s},ZC:function(){return r}})},5578:function(t,e,n){n.d(e,{Z:function(){return Z}});var l=n(3396),a=n(7139);const s=t=>((0,l.dD)("data-v-85fd2866"),t=t(),(0,l.Cn)(),t),r={class:"comment"},o={class:"comment-title"},u=s((()=>(0,l._)("span",null,"评论",-1))),c={class:"comment-desc"},i=(0,l.Uk)("发表评论"),g={class:"popular"},p={class:"popular-msg"},m={class:"name"},d={class:"time"},f={class:"content"},y=["onClick"];function v(t,e,n,s,v,I){const h=(0,l.up)("el-input"),w=(0,l.up)("el-button"),S=(0,l.up)("el-image"),_=(0,l.up)("yin-icon"),x=(0,l.up)("delete"),D=(0,l.up)("el-icon");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("h2",o,[u,(0,l._)("span",c,"共 "+(0,a.zw)(t.commentList.length)+" 条评论",1)]),(0,l.Wm)(h,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:t.textarea,"onUpdate:modelValue":e[0]||(e[0]=e=>t.textarea=e)},null,8,["modelValue"]),(0,l.Wm)(w,{class:"sub-btn",type:"primary",onClick:e[1]||(e[1]=e=>t.submitComment())},{default:(0,l.w5)((()=>[i])),_:1})]),(0,l._)("ul",g,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.commentList,((e,n)=>((0,l.wg)(),(0,l.iD)("li",{key:n},[(0,l.Wm)(S,{class:"popular-img",fit:"contain",src:t.attachImageUrl(e.avator)},null,8,["src"]),(0,l._)("div",p,[(0,l._)("ul",null,[(0,l._)("li",m,(0,a.zw)(e.username),1),(0,l._)("li",d,(0,a.zw)(t.formatDate(e.createTime)),1),(0,l._)("li",f,(0,a.zw)(e.content),1)])]),(0,l._)("div",{ref_for:!0,ref:"up",class:"comment-ctr",onClick:n=>t.setSupport(e.id,e.up,t.userId)},[(0,l._)("div",null,[(0,l.Wm)(_,{icon:t.iconList.Support},null,8,["icon"]),(0,l.Uk)(" "+(0,a.zw)(e.up),1)]),e.userId===t.userId?((0,l.wg)(),(0,l.j4)(D,{key:0,onClick:l=>t.deleteComment(e.id,n)},{default:(0,l.w5)((()=>[(0,l.Wm)(x)])),_:2},1032,["onClick"])):(0,l.kq)("",!0)],8,y)])))),128))])],64)}var I=n(4870),h=n(9749),w=n(547),S=n(3089),_=n(8045),x=n(2167),D=n(754),k=n(2024),C=(0,l.aZ)({components:{YinIcon:S.Z,Delete:w.Z},props:{playId:Number||String,type:Number},setup(t){const{proxy:e}=(0,l.FN)(),n=(0,h.oR)(),{checkStatus:a}=(0,_.Z)(),{playId:s,type:r}=(0,I.BK)(t),o=(0,I.iH)([]),u=(0,I.iH)(""),c=(0,I.qj)({Support:D.JO.Support}),i=(0,l.Fl)((()=>n.getters.userId)),g=(0,l.Fl)((()=>n.getters.songId));async function p(){try{const t=await x.x.getAllComment(r.value,s.value);o.value=t.data;for(let e=0;e<o.value.length;e++){const t=await x.x.getUserOfId(o.value[e].userId);o.value[e].avator=t.data[0].avator,o.value[e].username=t.data[0].username}}catch(t){console.error(t)}}async function m(){if(!a())return;let t=null,n=null,l=null;1===r.value?(l=1,t=`${s.value}`):0===r.value&&(l=0,n=`${s.value}`);const o=i.value,c=u.value,g=await x.x.setComment({userId:o,content:c,songId:n,songListId:t,nowType:l});e.$message({message:g.message,type:g.type}),g.success&&(u.value="",await p())}async function d(t,n){const l=await x.x.deleteComment(t);e.$message({message:l.message,type:l.type}),l.success&&o.value.splice(n,1)}async function f(t,n,l){if(!a())return;let s=null,r=null;const o=t,u=await x.x.testAlreadySupport({commentId:o,userId:l});e.$message({message:u.message,type:u.type,date:u.data}),u.data?(n-=1,r=await x.x.deleteUserSupport({commentId:o,userId:l}),s=await x.x.setSupport({id:t,up:n})):(n+=1,r=await x.x.insertUserSupport({commentId:o,userId:l}),s=await x.x.setSupport({id:t,up:n})),s.success&&r.success&&await p()}return(0,l.YP)(g,(()=>{p()})),(0,l.bv)((()=>{p()})),{userId:i,commentList:o,textarea:u,iconList:c,attachImageUrl:x.x.attachImageUrl,submitComment:m,setSupport:f,formatDate:k.p6,deleteComment:d}}}),F=n(89);const z=(0,F.Z)(C,[["render",v],["__scopeId","data-v-85fd2866"]]);var Z=z},3089:function(t,e,n){n.d(e,{Z:function(){return i}});var l=n(3396);const a={class:"icon","aria-hidden":"true"},s=["xlink:href"];function r(t,e,n,r,o,u){return(0,l.wg)(),(0,l.iD)("svg",a,[(0,l._)("use",{"xlink:href":t.icon},null,8,s)])}var o=(0,l.aZ)({props:{icon:String}}),u=n(89);const c=(0,u.Z)(o,[["render",r]]);var i=c},6933:function(t,e,n){n.r(e),n.d(e,{default:function(){return D}});var l=n(3396),a=n(7139),s=n(9242);const r=t=>((0,l.dD)("data-v-da118eac"),t=t(),(0,l.Cn)(),t),o={class:"song-container"},u={class:"song-info"},c={class:"container"},i={class:"lyric-container"},g={class:"song-lyric"},p={class:"no-lyric",key:"no-lyric"},m=r((()=>(0,l._)("span",null,"暂无歌词",-1))),d=[m];function f(t,e,n,r,m,f){const y=(0,l.up)("el-image"),v=(0,l.up)("comment");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",o,[(0,l.Wm)(y,{class:"song-pic",fit:"contain",src:t.attachImageUrl(t.songPic)},null,8,["src"]),(0,l._)("ul",u,[(0,l._)("li",null,"歌手："+(0,a.zw)(t.singerName),1),(0,l._)("li",null,"歌曲："+(0,a.zw)(t.songTitle),1)])]),(0,l._)("div",c,[(0,l._)("div",i,[(0,l._)("div",g,[(0,l.Wm)(s.W3,{name:"lyric-fade"},{default:(0,l.w5)((()=>[t.lyricArr.length?((0,l.wg)(),(0,l.iD)("ul",{style:(0,a.j5)({top:t.lrcTop}),class:"has-lyric",key:"has-lyric"},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.lyricArr,((t,e)=>((0,l.wg)(),(0,l.iD)("li",{key:e},(0,a.zw)(t[1]),1)))),128))],4)):((0,l.wg)(),(0,l.iD)("div",p,d))])),_:1})]),(0,l.Wm)(v,{playId:t.songId,type:0},null,8,["playId"])])])],64)}var y=n(4870),v=n(9749),I=n(5578),h=n(2024),w=n(2167),S=(0,l.aZ)({components:{Comment:I.Z},setup(){const t=(0,v.oR)(),e=(0,y.iH)("80px"),n=(0,y.iH)([]),a=(0,l.Fl)((()=>t.getters.songId)),s=(0,l.Fl)((()=>t.getters.lyric)),r=(0,l.Fl)((()=>t.getters.currentPlayList)),o=(0,l.Fl)((()=>t.getters.currentPlayIndex)),u=(0,l.Fl)((()=>t.getters.curTime)),c=(0,l.Fl)((()=>t.getters.songTitle)),i=(0,l.Fl)((()=>t.getters.singerName)),g=(0,l.Fl)((()=>t.getters.songPic));return(0,l.YP)(a,(()=>{n.value=(0,h.zu)(r.value[o.value].lyric)})),(0,l.YP)(u,(()=>{if(0!==n.value.length)for(let t=0;t<n.value.length;t++)if(u.value>=n.value[t][0]){for(let t=0;t<n.value.length;t++)document.querySelectorAll(".has-lyric li")[t].style.color="#000",document.querySelectorAll(".has-lyric li")[t].style.fontSize="14px";t>=0&&(e.value=30*-t+50+"px",document.querySelectorAll(".has-lyric li")[t].style.color="#95d2f6",document.querySelectorAll(".has-lyric li")[t].style.fontSize="18px")}})),n.value=s.value?(0,h.zu)(s.value):[],{songPic:g,singerName:i,songTitle:c,lrcTop:e,lyricArr:n,songId:a,attachImageUrl:w.x.attachImageUrl}}}),_=n(89);const x=(0,_.Z)(S,[["render",f],["__scopeId","data-v-da118eac"]]);var D=x}}]);
//# sourceMappingURL=933.0334d0bc.js.map