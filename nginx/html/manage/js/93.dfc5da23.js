"use strict";(self["webpackChunkmusic_manage"]=self["webpackChunkmusic_manage"]||[]).push([[93],{179:function(e,t,l){l.d(t,{JO:function(){return n},c6:function(){return a},wC:function(){return o}});var n;(function(e){e["BOFANG"]="#icon-bofanganniu",e["ZANTING"]="#icon-zanting"})(n||(n={}));const a="music";var o;(function(e){e["Home"]="/home",e["Info"]="/info",e["Song"]="/song",e["Singer"]="/singer",e["SongList"]="/songList",e["ListSong"]="/listSong",e["Comment"]="/Comment",e["Consumer"]="/consumer",e["Collect"]="/collect",e["Error"]="/404",e["SignIn"]="/",e["SignOut"]="0"})(o||(o={}))},8045:function(e,t,l){l.d(t,{Z:function(){return i}});var n=l(3396),a=l(4870),o=l(179);function i(){const{proxy:e}=(0,n.FN)(),t=(0,a.iH)(["jpg","jpeg","png","gif"]);function l(e){return 0===e?"女":1===e?"男":2===e?"组合":3===e?"不明":"男"===e||"女"===e?e:void 0}function i(l){const n=2,a=l.size/1024/1024<n,o=t.value.includes(l.type.replace(/image\//,""));return o||e.$message.error(`图片只支持 ${t.value.join("、")} 格式!`),a||e.$message.error(`上传头像图片大小不能超过 ${n}MB!`),o&&a}function r(t){const l=10,n=t.size/1024/1024<l,a=t.name.substring(t.name.lastIndexOf(".")+1),o="mp3"===a;return o||e.$message({message:"上传文件只能是mp3格式！",type:"error"}),n||e.$message.error(`上传头像图片大小不能超过 ${l}MB!`),o&&n}function u(t,l){switch(t){case o.wC.Song:case o.wC.ListSong:case o.wC.Comment:case o.wC.Consumer:case o.wC.Collect:e.$router.push({path:l.path,query:l.query});break;case o.wC.Home:case o.wC.SignIn:case o.wC.SignOut:case o.wC.Info:case o.wC.Singer:case o.wC.SongList:case o.wC.Error:default:e.$router.push({path:l.path});break}}function s(t=-1){e.$router.go(t)}return{changeSex:l,routerManager:u,goBack:s,beforeImgUpload:i,beforeSongUpload:r}}},2024:function(e,t,l){function n(e){if(null==e||""==e)return"";const t=new Date(e),l=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getDate()<10?"0"+t.getDate():t.getDate();return l+"-"+n+"-"+a}function a(e){const t=e.split("\n"),l=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,n=[];if(!/\[.+\]/.test(e))return[e];for(const a of t)if(l.test(a)){const e=a.replace(l,"");n.push(e)}return n}l.d(t,{o:function(){return n},z:function(){return a}})},1937:function(e,t,l){l.d(t,{Z:function(){return g}});var n=l(3396);const a=(0,n._)("div",{class:"del-dialog-cnt",align:"center"},"删除不可恢复，是否确定删除？",-1),o={class:"dialog-footer"},i=(0,n.Uk)("取 消"),r=(0,n.Uk)("确 定");function u(e,t,l,u,s,c){const d=(0,n.up)("el-button"),m=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(m,{title:"提示",modelValue:e.centerDialogVisible,"onUpdate:modelValue":t[0]||(t[0]=t=>e.centerDialogVisible=t),width:"300px",center:""},{footer:(0,n.w5)((()=>[(0,n._)("span",o,[(0,n.Wm)(d,{onClick:e.cancelRow},{default:(0,n.w5)((()=>[i])),_:1},8,["onClick"]),(0,n.Wm)(d,{type:"primary",onClick:e.confirm},{default:(0,n.w5)((()=>[r])),_:1},8,["onClick"])])])),default:(0,n.w5)((()=>[a])),_:1},8,["modelValue"])])}var s=l(4870),c=(0,n.aZ)({props:{delVisible:Boolean},emits:["cancelRow","confirm"],setup(e){const{proxy:t}=(0,n.FN)(),{delVisible:l}=(0,s.BK)(e),a=(0,s.iH)(l.value);function o(){t.$emit("cancelRow",!1)}function i(){t.$emit("confirm",null)}return(0,n.YP)(l,(e=>{a.value=e})),{centerDialogVisible:a,cancelRow:o,confirm:i}}}),d=l(89);const m=(0,d.Z)(c,[["render",u]]);var g=m},4093:function(e,t,l){l.r(t),l.d(t,{default:function(){return R}});var n=l(3396),a=l(7139);const o=e=>((0,n.dD)("data-v-8388baf6"),e=e(),(0,n.Cn)(),e),i={class:"container"},r={class:"handle-box"},u=(0,n.Uk)("批量删除"),s=(0,n.Uk)("添加歌曲"),c={style:{width:"80px",height:"80px",overflow:"hidden"}},d=["src"],m=["onClick"],g={class:"icon","aria-hidden":"true"},p=["xlink:href"],f={style:{height:"100px",overflow:"scroll"}},w=(0,n.Uk)("更新图片"),b=o((()=>(0,n._)("br",null,null,-1))),y=(0,n.Uk)("更新歌曲"),h=(0,n.Uk)("评论"),v=(0,n.Uk)("编辑"),C=(0,n.Uk)("删除"),_=o((()=>(0,n._)("input",{type:"file",name:"file"},null,-1))),W={class:"dialog-footer"},V=(0,n.Uk)("取 消"),S=(0,n.Uk)("确 定"),k={class:"dialog-footer"},U=(0,n.Uk)("取 消"),I=(0,n.Uk)("确 定");function F(e,t,l,o,F,x){const D=(0,n.up)("el-breadcrumb-item"),$=(0,n.up)("el-breadcrumb"),H=(0,n.up)("el-button"),N=(0,n.up)("el-input"),q=(0,n.up)("el-table-column"),z=(0,n.up)("el-upload"),L=(0,n.up)("el-table"),O=(0,n.up)("el-pagination"),B=(0,n.up)("el-form-item"),R=(0,n.up)("el-form"),Z=(0,n.up)("el-dialog"),P=(0,n.up)("yin-del-dialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)($,{class:"crumbs",separator:"/"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.breadcrumbList,(e=>((0,n.wg)(),(0,n.j4)(D,{key:e.name,to:{path:e.path,query:e.query}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.name),1)])),_:2},1032,["to"])))),128))])),_:1}),(0,n._)("div",i,[(0,n._)("div",r,[(0,n.Wm)(H,{onClick:e.deleteAll},{default:(0,n.w5)((()=>[u])),_:1},8,["onClick"]),(0,n.Wm)(N,{modelValue:e.searchWord,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchWord=t),placeholder:"筛选关键词"},null,8,["modelValue"]),(0,n.Wm)(H,{type:"primary",onClick:t[1]||(t[1]=t=>e.centerDialogVisible=!0)},{default:(0,n.w5)((()=>[s])),_:1})]),(0,n.Wm)(L,{height:"550px",border:"",size:"small",data:e.data,onSelectionChange:e.handleSelectionChange},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{type:"selection",width:"40"}),(0,n.Wm)(q,{label:"ID",prop:"id",width:"50",align:"center"}),(0,n.Wm)(q,{label:"歌手图片",width:"110",align:"center"},{default:(0,n.w5)((t=>[(0,n._)("div",c,[(0,n._)("img",{src:e.attachImageUrl(t.row.pic),style:{width:"100%"}},null,8,d)]),(0,n._)("div",{class:"play",onClick:l=>e.setSongUrl(t.row)},[((0,n.wg)(),(0,n.iD)("svg",g,[(0,n._)("use",{"xlink:href":e.toggle===t.row.name?e.playIcon:e.BOFANG},null,8,p)]))],8,m)])),_:1}),(0,n.Wm)(q,{label:"歌名",prop:"name",width:"150"}),(0,n.Wm)(q,{label:"专辑",prop:"introduction",width:"150"}),(0,n.Wm)(q,{label:"歌词",align:"center"},{default:(0,n.w5)((t=>[(0,n._)("ul",f,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.parseLyric(t.row.lyric),((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},(0,a.zw)(e),1)))),128))])])),_:1}),(0,n.Wm)(q,{label:"资源更新",width:"120",align:"center"},{default:(0,n.w5)((t=>[(0,n.Wm)(z,{action:e.updateSongImg(t.row.id),"show-file-list":!1,"on-success":e.handleImgSuccess,"before-upload":e.beforeImgUpload},{default:(0,n.w5)((()=>[(0,n.Wm)(H,null,{default:(0,n.w5)((()=>[w])),_:1})])),_:2},1032,["action","on-success","before-upload"]),b,(0,n.Wm)(z,{action:e.updateSongUrl(t.row.id),"show-file-list":!1,"on-success":e.handleSongSuccess,"before-upload":e.beforeSongUpload},{default:(0,n.w5)((()=>[(0,n.Wm)(H,null,{default:(0,n.w5)((()=>[y])),_:1})])),_:2},1032,["action","on-success","before-upload"])])),_:1}),(0,n.Wm)(q,{label:"评论",width:"90",align:"center"},{default:(0,n.w5)((t=>[(0,n.Wm)(H,{onClick:l=>e.goCommentPage(t.row.id)},{default:(0,n.w5)((()=>[h])),_:2},1032,["onClick"])])),_:1}),(0,n.Wm)(q,{label:"操作",width:"160",align:"center"},{default:(0,n.w5)((t=>[(0,n.Wm)(H,{onClick:l=>e.editRow(t.row)},{default:(0,n.w5)((()=>[v])),_:2},1032,["onClick"]),(0,n.Wm)(H,{type:"danger",onClick:l=>e.deleteRow(t.row.id)},{default:(0,n.w5)((()=>[C])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,n.Wm)(O,{class:"pagination",background:"",layout:"total, prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.tableData.length,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onCurrentChange"])]),(0,n.Wm)(Z,{title:"添加歌曲",modelValue:e.centerDialogVisible,"onUpdate:modelValue":t[6]||(t[6]=t=>e.centerDialogVisible=t)},{footer:(0,n.w5)((()=>[(0,n._)("span",W,[(0,n.Wm)(H,{onClick:t[5]||(t[5]=t=>e.centerDialogVisible=!1)},{default:(0,n.w5)((()=>[V])),_:1}),(0,n.Wm)(H,{type:"primary",onClick:e.addSong},{default:(0,n.w5)((()=>[S])),_:1},8,["onClick"])])])),default:(0,n.w5)((()=>[(0,n.Wm)(R,{id:"add-song","label-width":"120px",model:e.registerForm},{default:(0,n.w5)((()=>[(0,n.Wm)(B,{label:"歌曲名"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{type:"text",name:"name",modelValue:e.registerForm.name,"onUpdate:modelValue":t[2]||(t[2]=t=>e.registerForm.name=t)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(B,{label:"专辑"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{type:"text",name:"introduction",modelValue:e.registerForm.introduction,"onUpdate:modelValue":t[3]||(t[3]=t=>e.registerForm.introduction=t)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(B,{label:"歌词"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{type:"textarea",name:"lyric",modelValue:e.registerForm.lyric,"onUpdate:modelValue":t[4]||(t[4]=t=>e.registerForm.lyric=t)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(B,{label:"歌曲上传"},{default:(0,n.w5)((()=>[_])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,n.Wm)(Z,{title:"编辑",modelValue:e.editVisible,"onUpdate:modelValue":t[11]||(t[11]=t=>e.editVisible=t)},{footer:(0,n.w5)((()=>[(0,n._)("span",k,[(0,n.Wm)(H,{onClick:t[10]||(t[10]=t=>e.editVisible=!1)},{default:(0,n.w5)((()=>[U])),_:1}),(0,n.Wm)(H,{type:"primary",onClick:e.saveEdit},{default:(0,n.w5)((()=>[I])),_:1},8,["onClick"])])])),default:(0,n.w5)((()=>[(0,n.Wm)(R,{model:e.editForm},{default:(0,n.w5)((()=>[(0,n.Wm)(B,{label:"歌曲"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{modelValue:e.editForm.name,"onUpdate:modelValue":t[7]||(t[7]=t=>e.editForm.name=t)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(B,{label:"简介"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{modelValue:e.editForm.introduction,"onUpdate:modelValue":t[8]||(t[8]=t=>e.editForm.introduction=t)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(B,{label:"歌词"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{type:"textarea",modelValue:e.editForm.lyric,"onUpdate:modelValue":t[9]||(t[9]=t=>e.editForm.lyric=t)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,n.Wm)(P,{delVisible:e.delVisible,onConfirm:e.confirm,onCancelRow:t[12]||(t[12]=t=>e.delVisible=t)},null,8,["delVisible","onConfirm"])],64)}var x=l(4870),D=l(65),$=l(8045),H=l(179),N=l(2167),q=l(2024),z=l(1937),L=(0,n.aZ)({components:{YinDelDialog:z.Z},setup(){const{proxy:e}=(0,n.FN)(),{routerManager:t,beforeImgUpload:l,beforeSongUpload:a}=(0,$.Z)(),o=(0,D.oR)(),i=(0,x.iH)([]),r=(0,x.iH)([]),u=(0,x.iH)(5),s=(0,x.iH)(1),c=(0,x.iH)(""),d=(0,x.iH)(""),m=(0,x.iH)(!1),g=(0,x.iH)(H.JO.BOFANG),p=(0,x.iH)(H.JO.ZANTING),f=(0,n.Fl)((()=>o.getters.breadcrumbList)),w=(0,n.Fl)((()=>o.getters.isPlay)),b=(0,n.Fl)((()=>w.value?p.value:g.value)),y=(0,n.Fl)((()=>i.value.slice((s.value-1)*u.value,s.value*u.value))),h=(0,x.iH)("");async function v(){i.value=[],r.value=[];const e=await N.x.getSongOfSingerId(c.value);i.value=e.data,r.value=e.data,s.value=1}function C(t){e.$store.commit("setUrl",t.url),m.value=t.name,w.value?e.$store.commit("setIsPlay",!1):e.$store.commit("setIsPlay",!0)}function _(e){return N.x.updateSongImg(e)}function W(e){return N.x.updateSongUrl(e)}function V(e){s.value=e}function S(t){e.$message({message:t.message,type:t.type}),t.success&&v()}function k(t,l){e.$message({message:t.message,type:t.type}),t.success&&v()}function U(l){const n=(0,x.qj)([{path:H.wC.Singer,name:"歌手管理"},{path:H.wC.Song,query:{id:c.value,name:d.value},name:"歌曲信息"},{path:"",name:"评论详情"}]);e.$store.commit("setBreadcrumbList",n),t(H.wC.Comment,{path:H.wC.Comment,query:{id:l,type:0}})}(0,n.YP)(h,(()=>{if(""===h.value)i.value=r.value;else{i.value=[];for(let e of r.value)e.name.includes(h.value)&&i.value.push(e)}})),c.value=e.$route.query.id,d.value=e.$route.query.name,e.$store.commit("setIsPlay",!1),v();const I=(0,x.iH)(!1),F=(0,x.qj)({name:"",singerName:"",introduction:"",lyric:""});function z(){const t=new FormData(document.getElementById("add-song"));t.append("singerId",c.value),t.set("name",d.value+"-"+t.get("name")),t.get("lyric")||t.set("lyric","[00:00:00]暂无歌词");const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(4===l.readyState&&200===l.status){let t=JSON.parse(l.response);e.$message({message:t.message,type:t.type}),t.success&&(v(),F.name="",F.singerName="",F.introduction="",F.lyric="")}},l.open("post",N.x.attachImageUrl("/song/add"),!1),l.send(t),I.value=!1}const L=(0,x.iH)(!1),O=(0,x.qj)({id:"",singerId:"",name:"",introduction:"",createTime:"",updateTime:"",pic:"",lyric:"",url:""});function B(e){Z.value=e.id,O.id=e.id,O.singerId=e.singerId,O.name=e.name,O.introduction=e.introduction,O.createTime=e.createTime,O.updateTime=e.updateTime,O.pic=e.pic,O.lyric=e.lyric,O.url=e.url,L.value=!0}async function R(){let t=O.id,l=O.singerId,n=O.name,a=O.introduction,o=O.lyric;const i=await N.x.updateSongMsg({id:t,singerId:l,name:n,introduction:a,lyric:o});e.$message({message:i.message,type:i.type}),i.success&&v(),L.value=!1}const Z=(0,x.iH)(-1),P=(0,x.iH)([]),A=(0,x.iH)(!1);async function M(){const t=await N.x.deleteSong(Z.value);e.$message({message:t.message,type:t.type}),t.success&&v(),A.value=!1}function T(e){Z.value=e,A.value=!0}function j(e){P.value=e}function G(){for(let e of P.value)T(e.id),M();P.value=[]}return{playIcon:b,toggle:m,searchWord:h,data:y,editForm:O,registerForm:F,tableData:i,centerDialogVisible:I,editVisible:L,delVisible:A,pageSize:u,currentPage:s,ZANTING:p,BOFANG:g,breadcrumbList:f,deleteAll:G,handleSelectionChange:j,handleCurrentChange:V,handleImgSuccess:k,beforeImgUpload:l,parseLyric:q.z,saveEdit:R,updateSongImg:_,updateSongUrl:W,deleteRow:T,confirm:M,attachImageUrl:N.x.attachImageUrl,addSong:z,editRow:B,handleSongSuccess:S,setSongUrl:C,beforeSongUpload:a,goCommentPage:U}}}),O=l(89);const B=(0,O.Z)(L,[["render",F],["__scopeId","data-v-8388baf6"]]);var R=B}}]);
//# sourceMappingURL=93.dfc5da23.js.map